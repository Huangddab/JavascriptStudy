<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>设备状态监控</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-[#71717A] text-gray-100 min-h-screen p-8">
    <div class="max-w-7xl mx-auto">
        <!-- 状态卡片 -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <!-- 温度卡片 -->
            <div class="bg-[#5A5A63] p-6 rounded-xl cursor-pointer hover:bg-[#82828C] transition-colors" onclick="showChart('temperature')">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-gray-300 text-sm">传感器温度</h3>
                        <p class="text-3xl font-bold" id="temp-value">--</p>
                    </div>
                    <div class="w-3 h-3 rounded-full bg-green-400" id="temp-status"></div>
                </div>
                <p class="text-gray-300 text-sm mt-2">工作范围: -20℃ ~ 60℃</p>
            </div>

            <!-- 气压卡片 -->
            <div class="bg-[#5A5A63] p-6 rounded-xl cursor-pointer hover:bg-[#82828C] transition-colors" onclick="showChart('pressure')">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-gray-300 text-sm">管路气压</h3>
                        <p class="text-3xl font-bold" id="press-value">--</p>
                    </div>
                    <div class="w-3 h-3 rounded-full bg-green-400" id="press-status"></div>
                </div>
                <p class="text-gray-300 text-sm mt-2">正常值: 20kPa ~ 30kPa</p>
            </div>

            <!-- 电压卡片 -->
            <div class="bg-[#5A5A63] p-6 rounded-xl cursor-pointer hover:bg-[#82828C] transition-colors" onclick="showChart('voltage')">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-gray-300 text-sm">电池电压</h3>
                        <p class="text-3xl font-bold" id="volt-value">--</p>
                    </div>
                    <div class="w-3 h-3 rounded-full bg-green-400" id="volt-status"></div>
                </div>
                <p class="text-gray-300 text-sm mt-2">正常值: 24V ±10%</p>
            </div>
        </div>

        <!-- 图表容器 -->
        <div class="bg-[#5A5A63] p-6 rounded-xl mb-8">
            <div class="h-96"> <!-- 添加固定高度容器 -->
                <canvas id="trendChart"></canvas>
            </div>
        </div>

        <!-- 故障诊断 -->
        <div class="bg-[#5A5A63] p-6 rounded-xl">
            <h2 class="text-xl font-bold mb-4">系统诊断</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="flex items-center justify-between p-4 bg-[#71717A] rounded-lg">
                    <span>动力系统</span>
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 rounded-full bg-green-400"></div>
                        <span>正常</span>
                    </div>
                </div>
                <div class="flex items-center justify-between p-4 bg-[#71717A] rounded-lg">
                    <span>冷却系统</span>
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 rounded-full bg-red-400"></div>
                        <span>故障</span>
                    </div>
                </div>
                <div class="flex items-center justify-between p-4 bg-[#71717A] rounded-lg">
                    <span>传感器阵列</span>
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 rounded-full bg-green-400"></div>
                        <span>正常</span>
                    </div>
                </div>
                <div class="flex items-center justify-between p-4 bg-[#71717A] rounded-lg">
                    <span>电源模块</span>
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 rounded-full bg-green-400"></div>
                        <span>正常</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 模拟实时数据
        function updateValues() {
            // 温度值（模拟）
            const temp = Math.random() * 80 - 20;
            document.getElementById('temp-value').textContent = `${temp.toFixed(1)}℃`;
            document.getElementById('temp-status').className = `w-3 h-3 rounded-full ${temp < -20 || temp > 60 ? 'bg-red-400' : 'bg-green-400'}`;

            // 气压值（模拟）
            const press = Math.random() * 40 + 10;
            document.getElementById('press-value').textContent = `${press.toFixed(1)}kPa`;
            document.getElementById('press-status').className = `w-3 h-3 rounded-full ${press < 20 || press > 30 ? 'bg-red-400' : 'bg-green-400'}`;

            // 电压值（模拟）
            const volt = 24 + (Math.random() * 4 - 2);
            document.getElementById('volt-value').textContent = `${volt.toFixed(1)}V`;
            document.getElementById('volt-status').className = `w-3 h-3 rounded-full ${volt < 21.6 || volt > 26.4 ? 'bg-red-400' : 'bg-green-400'}`;
        }

        // 初始化图表
        let chart;
        const ctx = document.getElementById('trendChart').getContext('2d');
        
        function initChart() {
            // 确保销毁旧图表
            if (chart) chart.destroy();

            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                    datasets: [{
                        label: '温度',
                        data: Array.from({length: 24}, () => Math.random() * 80 - 20),
                        borderColor: '#34D399',
                        borderWidth: 2,
                        tension: 0.4,
                        hidden: false
                    },{
                        label: '气压',
                        data: Array.from({length: 24}, () => Math.random() * 40 + 10),
                        borderColor: '#60A5FA',
                        borderWidth: 2,
                        tension: 0.4,
                        hidden: true
                    },{
                        label: '电压',
                        data: Array.from({length: 24}, () => 24 + (Math.random() * 4 - 2)),
                        borderColor: '#FBBF24',
                        borderWidth: 2,
                        tension: 0.4,
                        hidden: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            labels: { 
                                color: '#E5E7EB',
                                font: {
                                    size: 14
                                }
                            } 
                        },
                        tooltip: {
                            backgroundColor: '#1F2937',
                            titleColor: '#E5E7EB',
                            bodyColor: '#E5E7EB'
                        }
                    },
                    scales: {
                        x: { 
                            grid: { 
                                color: '#4B5563',
                                lineWidth: 1
                            }, 
                            ticks: { 
                                color: '#D1D5DB',
                                maxRotation: 0,
                                autoSkip: true
                            },
                            title: {
                                display: true,
                                text: '时间（小时）',
                                color: '#D1D5DB'
                            }
                        },
                        y: { 
                            grid: { 
                                color: '#4B5563',
                                lineWidth: 1
                            }, 
                            ticks: { 
                                color: '#D1D5DB',
                                callback: function(value) {
                                    return value + (this.dataset === 'temperature' ? '℃' : 
                                                   this.dataset === 'pressure' ? 'kPa' : 'V');
                                }
                            },
                            title: {
                                display: true,
                                text: '数值',
                                color: '#D1D5DB'
                            }
                        }
                    },
                    interaction: {
                        mode: 'nearest',
                        intersect: false
                    }
                }
            });
        }

        // 显示图表
        function showChart(type) {
            chart.data.datasets.forEach(ds => {
                ds.hidden = !ds.label.toLowerCase().includes(type);
            });
            chart.update();
        }

        // 初始化
        window.addEventListener('DOMContentLoaded', () => {
            initChart();
            setInterval(updateValues, 2000);
            updateValues();
        });
    </script>
</body>
</html>