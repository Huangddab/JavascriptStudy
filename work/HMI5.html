<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>工业气体监测系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>

<body class="bg-[#0a1929] text-gray-200">
    <div class="w-[1024px] h-[600px] relative overflow-hidden">
        <!-- 状态栏 -->
        <div class="h-14 px-6 flex items-center bg-[#122738]/70 backdrop-blur-md border-b border-[#2a4d69]">
            <div class="flex-1">
                <h1 class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-400">
                    ENBoso
                </h1>
            </div>
            <div class="flex gap-5 items-center">
                <div class="flex items-center gap-2">
                    <svg class="w-5 h-5 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    <span class="font-mono">设备在线</span>
                </div>
                <div class="w-px h-6 bg-[#2a4d69]"></div>
                <div id="clock" class="font-mono text-cyan-300">15:52:15</div>
            </div>
        </div>

        <!-- 三维粒子画布 -->
        <canvas id="particleCanvas" class="absolute inset-0"></canvas>

        <!-- 中央状态指示器 -->
        <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2">
            <div class="relative w-64 h-64">
                <div class="absolute inset-0 rounded-full border-4 border-[#2a4d69] animate-pulse-ring"></div>
                <div id="statusRing" class="absolute inset-2 rounded-full border-[9px] border-green-400 
                    shadow-[0_0_30px_5px_rgba(74,222,128,0.3)] transition-all duration-500">
                    <div class="absolute inset-0 bg-gradient-to-b from-[#1a2f3d] to-[#0a1929] rounded-full"></div>
                </div>
                <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 text-center">
                    <div class="text-4xl font-bold mb-2">
                        正常
                        <div class="text-2xl font-bold mb-2">舒适度：优</div>
                    </div>

                    <!-- <div class="flex justify-center items-center gap-x-2">
                        <svg class="w-6 h-6 animate-spin" fill="currentColor" viewBox="0 0 24 24">
                            <path
                                d="M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12s4.579 10 10 10z" />
                        </svg>
                        <div class="text-sm opacity-80">实时监测中</div>
                    </div> -->
                </div>
            </div>
        </div>
        <div class="absolute bottom-0 left-1/2 -translate-x-1/2 mb-4">
            <div class="flex justify-center space-x-6  text-cyan-400">
                <svg class="w-8 h-8 animate-spin" fill="currentColor" viewBox="0 0 24 24">
                    <path
                        d="M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12s4.579 10 10 10z" />
                </svg>
                <div class="text-2xl">
                    <span>持续监测中 · 已运行</span>
                    <span id="uptime" class="font-mono ml-2">00:28:15</span>
                </div>
            </div>
        </div>

        <!-- 报警层 -->
        <!-- <div id="alertLayer" class="absolute inset-0 bg-[#8b0000]/80 backdrop-blur-lg hidden 
            transition-opacity duration-300">
            <div class="flex flex-col items-center justify-center h-full space-y-8">
                <div class="text-6xl font-bold animate-pulse">⚠️ 危险警报</div>
                <div id="alertContent" class="text-3xl font-mono text-center leading-relaxed"></div>
                <button onclick="dismissAlert()" class="px-12 py-4 bg-gradient-to-r from-red-600 to-orange-500 rounded-xl 
                    shadow-lg hover:scale-105 transition-transform">
                    确认警报
                </button>
            </div>
        </div> -->
    </div>

    <script>
        // 三维粒子系统
        const particleScene = new THREE.Scene();
        const particleCamera = new THREE.PerspectiveCamera(75, 1024 / 600, 0.1, 1000);
        const particleRenderer = new THREE.WebGLRenderer({
            canvas: document.getElementById('particleCanvas'),
            alpha: true,
            antialias: true
        });
        particleRenderer.setSize(1024, 600);

        // 粒子材质配置
        const particleMaterial = new THREE.PointsMaterial({
            size: 0.08,
            color: 0x2a4d69,
            transparent: true,
            opacity: 0.4,
            depthWrite: false,
            blending: THREE.AdditiveBlending
        });

        // 初始化粒子系统
        const createParticles = () => {
            const geometry = new THREE.BufferGeometry();
            const positions = [];

            // 球面坐标生成初始位置
            for (let i = 0; i < 2000; i++) {
                const radius = 10 + Math.random() * 4;
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.acos(2 * Math.random() - 1);

                positions.push(
                    radius * Math.sin(phi) * Math.cos(theta),
                    radius * Math.sin(phi) * Math.sin(theta),
                    radius * Math.cos(phi)
                );
            }

            geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
            return new THREE.Points(geometry, particleMaterial);
        };

        const particleSystem = createParticles();
        particleScene.add(particleSystem);
        particleCamera.position.z = 15;

        // 强向心粒子动画
        function animateParticles() {
            requestAnimationFrame(animateParticles);

            const positions = particleSystem.geometry.attributes.position.array;
            const center = new THREE.Vector3(0, 0, 0);

            for (let i = 0; i < positions.length; i += 3) {
                const position = new THREE.Vector3(
                    positions[i],
                    positions[i + 1],
                    positions[i + 2]
                );

                // 计算向心方向
                const direction = center.clone().sub(position).normalize();
                const distance = position.distanceTo(center);

                // 动态速度：离中心越近速度越快
                const baseSpeed = 0.02;
                const speed = baseSpeed * (1 + 5 / (distance + 0.5));

                // 更新位置
                position.add(direction.multiplyScalar(speed));

                // 重置机制（到达中心区域后重置到外围）
                if (distance < 3) {
                    const theta = Math.random() * Math.PI * 2;
                    const phi = Math.acos(2 * Math.random() - 1);
                    const radius = 12 + Math.random() * 4;

                    position.set(
                        radius * Math.sin(phi) * Math.cos(theta),
                        radius * Math.sin(phi) * Math.sin(theta),
                        radius * Math.cos(phi)
                    );
                }

                // 更新坐标
                positions[i] = position.x;
                positions[i + 1] = position.y;
                positions[i + 2] = position.z;
            }

            particleSystem.geometry.attributes.position.needsUpdate = true;
            particleSystem.rotation.y += 0.0003;
            particleRenderer.render(particleScene, particleCamera);
        }
        animateParticles();

        // 状态管理系统
        let currentStatus = 'normal';
        const statusMap = {
            normal: { color: '#4ade80', text: '正常' },
            warning: { color: '#f59e0b', text: '预警' },
            danger: { color: '#ef4444', text: '危险' }
        };

        const substanceDB = {
            danger: [
                { name: "甲烷(CH₄)", unit: "PPM", range: [1000, 5000] },
                { name: "硫化氢(H₂S)", unit: "PPM", range: [50, 200] },
                { name: "氰化氢(HCN)", unit: "ppm", range: [10, 50] }
            ],
            warning: [
                { name: "一氧化碳(CO)", unit: "PPM", range: [100, 500] },
                { name: "挥发性有机物(VOCs)", unit: "mg/m³", range: [50, 200] },
                { name: "氧气(O₂)", unit: "Vol%", range: [5, 19.5] }
            ]
        };

        function triggerAlert(level) {
            const substances = substanceDB[level];
            const selected = substances[Math.floor(Math.random() * substances.length)];
            const concentration = Math.floor(Math.random() * (selected.range[1] - selected.range[0])) + selected.range[0];

            // 更新状态环
            const status = statusMap[level];
            document.getElementById('statusRing').style.borderColor = status.color;
            document.getElementById('statusRing').style.boxShadow = `0 0 30px 5px ${status.color}40`;
            document.querySelector('#statusRing + div div').innerHTML = `
                <div class="text-2xl">${selected.name}</div>
                <div class="text-4xl font-bold my-1">${concentration}${selected.unit}</div>
                <div class="text-sm">${status.text}状态</div>
            `;

            // 显示警报层
            const alertLayer = document.getElementById('alertLayer');
            alertLayer.classList.remove('hidden');
            alertLayer.style.opacity = '1';
            document.getElementById('alertContent').innerHTML = `
                检测到：<span class="font-mono">${selected.name}</span><br>
                当前浓度：<span class="text-3xl font-bold">${concentration}${selected.unit}</span><br>
                <span class="text-sm opacity-80">${getAlertDescription(selected.name)}</span>
            `;
        }

        function dismissAlert() {
            const alertLayer = document.getElementById('alertLayer');
            alertLayer.style.opacity = '0';
            setTimeout(() => alertLayer.classList.add('hidden'), 300);
            currentStatus = 'normal';
            document.getElementById('statusRing').style.borderColor = statusMap.normal.color;
            document.getElementById('statusRing').style.boxShadow = `0 0 30px 5px ${statusMap.normal.color}30`;
        }

        function getAlertDescription(name) {
            const descriptions = {
                "甲烷(CH₄)": "爆炸下限 5% | 立即切断气源",
                "硫化氢(H₂S)": "安全阈值 10ppm | 启动强排风",
                "氰化氢(HCN)": "剧毒物质 | 启动区域隔离",
                "一氧化碳(CO)": "安全阈值 35ppm | 建议通风",
                "挥发性有机物(VOCs)": "TVOC超标 | 检查泄漏点",
                "氧气(O₂)": "缺氧环境 | 禁止明火"
            };
            return descriptions[name] || "检测参数异常，请人工确认";
        }

        // 模拟检测
        setInterval(() => {
            const val = Math.random();
            if (val > 0.97) triggerAlert('danger');
            else if (val > 0.92) triggerAlert('warning');
        }, 3000);

        // 实时时钟
        function updateClock() {
            const now = new Date();
            document.getElementById('clock').textContent =
                `${now.getHours().toString().padStart(2, '0')}:` +
                `${now.getMinutes().toString().padStart(2, '0')}:` +
                `${now.getSeconds().toString().padStart(2, '0')}`;
            requestAnimationFrame(updateClock);
        }
        updateClock();
    </script>

    <style>
        @keyframes pulse-ring {
            0% {
                opacity: 0.5;
                transform: scale(1);
            }

            100% {
                opacity: 0;
                transform: scale(1.3);
            }
        }

        .animate-pulse-ring {
            animation: pulse-ring 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        .backdrop-blur-lg {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }
    </style>
</body>

</html>