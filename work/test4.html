<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¯å¢ƒå‚æ•°ç›‘æµ‹ç³»ç»Ÿ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .chart-container {
            position: relative;
            width: 100%;
            height: 80px;
        }
        
        .data-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(8px);
        }

        .trend-arrow {
            transition: transform 0.3s ease;
        }
    </style>
</head>
<body class="bg-slate-900 text-gray-100 min-h-screen p-6">
    <div class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <!-- æ¸©åº¦ -->
        <div class="data-card rounded-xl p-4">
            <div class="flex justify-between items-center mb-2">
                <div class="flex items-center space-x-2">
                    <span class="text-sm">ğŸŒ¡ï¸ æ¸©åº¦</span>
                    <span id="tempTrend" class="trend-arrow">â†’</span>
                </div>
                <span id="tempValue" class="text-2xl font-bold">--</span>
            </div>
            <div class="chart-container">
                <canvas id="tempChart"></canvas>
            </div>
            <div class="text-xs text-gray-400 mt-1">å•ä½: â„ƒ</div>
        </div>

        <!-- æ¹¿åº¦ -->
        <div class="data-card rounded-xl p-4">
            <div class="flex justify-between items-center mb-2">
                <div class="flex items-center space-x-2">
                    <span class="text-sm">ğŸ’§ æ¹¿åº¦</span>
                    <span id="humidityTrend" class="trend-arrow">â†’</span>
                </div>
                <span id="humidityValue" class="text-2xl font-bold">--</span>
            </div>
            <div class="chart-container">
                <canvas id="humidityChart"></canvas>
            </div>
            <div class="text-xs text-gray-400 mt-1">å•ä½: %</div>
        </div>

        <!-- é£é€Ÿ -->
        <div class="data-card rounded-xl p-4">
            <div class="flex justify-between items-center mb-2">
                <div class="flex items-center space-x-2">
                    <span class="text-sm">ğŸŒ¬ï¸ é£é€Ÿ</span>
                    <span id="windTrend" class="trend-arrow">â†’</span>
                </div>
                <span id="windValue" class="text-2xl font-bold">--</span>
            </div>
            <div class="chart-container">
                <canvas id="windChart"></canvas>
            </div>
            <div class="text-xs text-gray-400 mt-1">å•ä½: m/s</div>
        </div>

        <!-- PM2.5 -->
        <div class="data-card rounded-xl p-4">
            <div class="flex justify-between items-center mb-2">
                <div class="flex items-center space-x-2">
                    <span class="text-sm">ğŸŸ¡ PM2.5</span>
                    <span id="pm25Trend" class="trend-arrow">â†’</span>
                </div>
                <span id="pm25Value" class="text-2xl font-bold">--</span>
            </div>
            <div class="chart-container">
                <canvas id="pm25Chart"></canvas>
            </div>
            <div class="text-xs text-gray-400 mt-1">å•ä½: Î¼g/mÂ³</div>
        </div>
    </div>

<script>
class EnvironmentMonitor {
    constructor() {
        this.historyLength = 60;
        this.params = {
            temp: this.initDataSeries(),
            humidity: this.initDataSeries(),
            wind: this.initDataSeries(),
            pm25: this.initDataSeries()
        };
        
        this.canvas = {
            temp: this.initChart('tempChart', '#f59e0b'),
            humidity: this.initChart('humidityChart', '#3b82f6'),
            wind: this.initChart('windChart', '#10b981'),
            pm25: this.initChart('pm25Chart', '#ef4444')
        };
        
        this.startMonitoring();
    }

    initDataSeries() {
        return Array(this.historyLength).fill(null).map(() => 0);
    }

    initChart(canvasId, color) {
        const canvas = document.getElementById(canvasId);
        const ctx = canvas.getContext('2d');
        
        // è®¾ç½®Canvasåˆ†è¾¨ç‡
        const dpr = window.devicePixelRatio || 1;
        const rect = canvas.getBoundingClientRect();
        canvas.width = rect.width * dpr;
        canvas.height = rect.height * dpr;
        ctx.scale(dpr, dpr);
        
        return { ctx, canvas, color };
    }

    updateChart(param) {
        const { ctx, canvas, color } = this.canvas[param];
        const data = this.params[param];
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // ç»˜åˆ¶èƒŒæ™¯ç½‘æ ¼
        ctx.strokeStyle = 'rgba(255,255,255,0.1)';
        ctx.beginPath();
        ctx.moveTo(0, canvas.height/2);
        ctx.lineTo(canvas.width, canvas.height/2);
        ctx.stroke();

        // ç»˜åˆ¶æŠ˜çº¿
        ctx.beginPath();
        ctx.strokeStyle = color;
        ctx.lineWidth = 2;
        
        data.forEach((value, index) => {
            const x = (index / (this.historyLength - 1)) * canvas.width;
            const y = canvas.height - (value / 100 * canvas.height);
            
            if(index === 0) {
                ctx.moveTo(x, y);
            } else {
                ctx.lineTo(x, y);
            }
        });
        
        ctx.stroke();
    }

    updateTrend(param, current, previous) {
        const trendElement = document.getElementById(`${param}Trend`);
        const diff = current - previous;
        
        trendElement.style.transform = `rotate(${diff > 0 ? '-45deg' : diff < 0 ? '45deg' : '0'})`;
        trendElement.style.color = diff > 0 ? '#ef4444' : diff < 0 ? '#10b981' : '#94a3b8';
    }

    generateData() {
        return {
            temp: 20 + Math.sin(Date.now()/10000) * 5 + Math.random(),
            humidity: 50 + Math.cos(Date.now()/8000) * 10 + Math.random(),
            wind: Math.abs(3 + Math.sin(Date.now()/5000) * 2 + Math.random()),
            pm25: Math.max(0, 30 + Math.sin(Date.now()/3000) * 25 + Math.random()*5)
        };
    }

    startMonitoring() {
        setInterval(() => {
            const newData = this.generateData();
            
            Object.keys(this.params).forEach(param => {
                // æ›´æ–°å†å²æ•°æ®
                this.params[param].push(newData[param]);
                this.params[param].shift();
                
                // æ›´æ–°å›¾è¡¨
                this.updateChart(param);
                
                // æ›´æ–°æ•°å€¼æ˜¾ç¤º
                document.getElementById(`${param}Value`).textContent = 
                    newData[param].toFixed(1);
                
                // æ›´æ–°è¶‹åŠ¿ç®­å¤´
                const previous = this.params[param][this.historyLength - 2];
                this.updateTrend(param, newData[param], previous);
            });
        }, 1000);
    }
}

// å¯åŠ¨ç›‘æµ‹ç³»ç»Ÿ
new EnvironmentMonitor();
</script>
</body>
</html>
